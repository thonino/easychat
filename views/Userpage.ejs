<!DOCTYPE html>
<html>
  <head>
    <title>Page utilisateur</title>
    <%- include('./partials/link') %>
  </head>
  <body>
    <%- include('./partials/nav') %>
    <div class="grid-container bg-white">
      <div class="topbar">
        <%- include('./partials/nav'); %>
      </div>
      <div class="sidebar bg-dark-less text-center d-none d-md-block">
        <%- include('./partials/contact'); %>
        <div class="link">
          <a 
            href="/addfriend" 
            class="btn btn-success btn-sm d-flex align-items-center fw-bold p-0 gap-2 px-2"
          >
            <i class="bi bi-person-fill-add fs-4"></i>
            Ajouter
          </a>
        </div>
      </div>
      <div class="flex-column align-items-center">
        <div class="bg-dark-less px-2">
          <div class="d-flex justify-content-between align-items-center py-2">
            <!-- Add friend -->
            <div>
              <a href="/addfriend" class="btn btn-success btn-sm d-md-none">
                <i class="bi bi-plus-lg"></i>
              </a>
            </div>
            <!-- Offcanvas toggle button for smaller screens -->
            <div class="d-flex justify-content-between align-items-center text-light">
              <span class="me-2 fst-italic text-info-light text-capitalize">
                A : 
                <span class="text-info fw-bold">
                  <%= chatting && friends.includes(chatting) ? chatting : 'Destinataire' %>
                </span>
              </span>
              <button 
                class="btn btn-light btn-sm d-md-none text-secondary text-capitalize fw-bold" 
                type="button" 
                data-bs-toggle="offcanvas" 
                data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                Boite
                <i class="bi bi-chat-square-text-fill"></i>
              </button>
            </div>
            <!-- Account -->
            <div>
              <a href="/account" class="btn btn-light btn-sm text-secondary">
                <i class="bi bi-person-lines-fill"></i>
              </a>
            </div>
          </div>
        </div>
        <div class="flex flex-column">
          <h1 class="text-center text-secondary my-2 fw-bold">Mes Amis :</h1>
          <% friends.forEach(data =>  { %>
            <div class="d-flex justify-content-center bg-info-light py-1 mt-1" >
              <div class="fw-bold text-secondary fs-5 gap-2" style="width: 250px;" >
                <span class="cursor-default" type="submit">
                  <i class="bi bi-person-check-fill text-light btn bg-info btn-sm cursor-default px-1 py-1"></i>
                </span>
                <span class="text-capitalize"><%= data %></span>
              </div>
              <form action="/chat" method="POST">
                <input type="hidden" name="destinataire" value="<%= data %>"/>
                <button class="btn px-2 fst-italic" type="submit" >
                  <i class="bi bi-chat-square-text-fill text-secondary fw-bold"> Ecrire..</i> 
                </button>
              </form>
              <!-- delete friend -->
              <button 
                type="button" 
                class="btn btn-sm ms-2" 
                data-bs-toggle="modal" 
                data-bs-target="#deleteFriendModal<%= data %>"
              >
                <i class="bi bi-dash-circle-fill text-danger"></i>
              </button>
            </div>
            <!-- Delete Modal -->
            <div 
            class="modal fade" 
            id="deleteFriendModal<%= data %>" tabindex="-1" 
            aria-labelledby="deleteFriendModalLabel<%= data %>" 
            aria-hidden="true"
            >
            <div class="modal-dialog">
              <div class="modal-content">
                <!--Title modal -->
                <div class="modal-header bg-danger-light">
                  <h5 
                    class="modal-title fw-bold" 
                    id="deleteFriendModalLabel<%= data %>"
                  >
                    Confirmer la suppression
                  </h5>
                  <!--Close btn -->
                  <button 
                    type="button" 
                    class="btn-close" 
                    data-bs-dismiss="modal" 
                    aria-label="Close">
                  </button>
                </div>
                <!--Body modal -->
                <div class="modal-body text-center">
                  <p>
                    Supprimer 
                    <span class="text-secondary fst-italic text-capitalize fw-bold"> 
                      "<%= data %>"
                    </span> 
                    de vos amis ?
                  </p>
                  
                </div>
                <!--Footer modal -->
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                  <form id="deleteFriend<%= data %>" action="/remove/deleted" method="POST">
                    <input type="hidden" name="adder" value="<%= data %>"/>
                    <button type="submit" class="btn btn-danger">Supprimer</button>
                  </button>
                  </form>
                </div>
              </div>
            </div>
            </div>
          <% }); %> 
        </div> 
      </div>
    </div>
    <%- include('./partials/offcanvas'); %>
  </body>
</html>
